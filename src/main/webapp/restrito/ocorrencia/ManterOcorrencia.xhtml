<ui:composition template="/WEB-INF/template/LayoutPadrao.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui">

	<ui:define name="corpo">

		<h1>Manter Ocorrencias</h1>
		
		<p:panelGrid>
		
		<p:row>
		<h:form id="formFiltro">
		    <p:panelGrid>
		    	<p:row>
		    		FILTRAR: 
			        <!-- Selecionar Coluna -->
			        <p:selectOneMenu id="coluna" value="#{manterOcorrenciaBean.colunaSelecionada}">
			        	<f:selectItem itemValue="codigo" itemLabel="Código" />
			            <f:selectItem itemValue="descricao" itemLabel="Descrição" />
			            <f:selectItem itemValue="tipo" itemLabel="Tipo" />
			            
			            <p:ajax event="change" update="inputPanel" process="@form" />
			        </p:selectOneMenu>
			        
			        
			
			        <!-- Valor do Filtro -->
			        <h:panelGroup id="inputPanel">
		                <p:inputText id="filtroPadrao" value="#{manterOcorrenciaBean.valorFiltro}" placeholder="Buscar... " 
		                             rendered="#{manterOcorrenciaBean.colunaSelecionada != 'tipo'}" />
		
		                <!-- SelectOneMenu renderizado quando a coluna 'tipo' for selecionada -->
		                <p:selectOneMenu id="filtroTipo" value="#{manterOcorrenciaBean.valorTipo}"
		                			     rendered="#{manterOcorrenciaBean.colunaSelecionada == 'tipo'}">
						    <!--  O FILTRO GERADO PELO BACKEND NAO ESTA FUNCIONANDO
						    <f:selectItems value="#{manterOcorrenciaBean.tiposOcorrencia}" var="tipo"
						                   itemValue="#{tipo}" itemLabel="#{tipo}" /> -->
						</p:selectOneMenu>
		            </h:panelGroup>
			
			        <!-- Botão para Filtrar -->
			        <p:commandButton value="Filtrar" actionListener="#{manterOcorrenciaBean.atualizarFiltro()}" update="tableOcorrencias" process="@form" />
			        <p:commandButton value="Limpar Filtro" actionListener="#{manterOcorrenciaBean.limparFiltro()}" update="tableOcorrencias" process="@form" />
			        <h:outputText value="#{manterOcorrenciaBean.colunaSelecionada}" />
		        </p:row>
		    </p:panelGrid>
		</h:form>
		
		</p:row>
		<p:row>
		
		<p:dataTable id="tableOcorrencias" value="#{manterOcorrenciaBean.lazyOcorrencias}" var="ocorrencia" lazy="true"
		emptyMessage="Nenhuma ocorrência registrada." paginator="true" rows="10"
		paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}">
			<p:column headerText="Código">
                <h:outputText value="#{ocorrencia.codigo}" />
            </p:column>
            <p:column headerText="Tipo" >
    			<h:outputText value="#{ocorrencia.tipo}" />
			</p:column>
		    <p:column headerText="Descrição" >
    			<h:outputText value="#{ocorrencia.descricao}" />
			</p:column>
		    <p:column headerText="Ações">
		    <!--  action="#{registrosBean.visualizar(registro.id)}"  -->
		        <p:commandButton value="Visualizar"     
		                         action="https://www.google.com" />
		                         <!--  update=":visualizarForm"/>  -->
		    </p:column>
		</p:dataTable>
		
		</p:row>
		
		</p:panelGrid>
		


	</ui:define>

</ui:composition>